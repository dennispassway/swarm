/*
  Swarm
  version: 1.0
  author: @dennispassway
  url: https://github.com/dennispassway/swarm
*/
var Swarm=function(a){numberOfParticles=a.numberOfParticles||100,backgroundColor=a.backgroundColor||"#000000",element=a.element||document.body,_draw=function(){window.requestAnimationFrame(_draw),this.canvasContext.fillStyle=backgroundColor,this.canvasContext.fillRect(0,0,this.canvas.width,this.canvas.height),this.particles.forEach(function(a){a.drawInCanvas(this.canvasContext),this.mouseIsPressed?a.moveToPosition(this.targetPosition,Math.random()*a.maximumMovementSpeed):a.moveToRandomPosition(Math.random()*5*a.maximumMovementSpeed)}.bind(this))}.bind(this),_initializeCanvas=function(){this.canvas=document.createElement("canvas"),this.canvas.width=Utils.getElementWidth(),this.canvas.height=Utils.getElementHeight(),element.innerHTML="",element.appendChild(this.canvas),this.canvasContext=this.canvas.getContext("2d"),this.canvasContext.fillStyle=backgroundColor,this.canvasContext.fillRect(0,0,this.canvas.width,this.canvas.height)}.bind(this),_initializeParticles=function(a){this.particles=[];for(var b=0;numberOfParticles>b;b++)this.particles.push(new Particle(a))}.bind(this),_initializeTargetPosition=function(){this.targetPosition={x:this.canvas.width/2,y:this.canvas.height/2}}.bind(this),_mouseMoveHandler=function(a){this.targetPosition.x=a.offsetX,this.targetPosition.y=a.offsetY}.bind(this),_mouseClickHandler=function(a){"mousedown"==a.type?this.mouseIsPressed=!0:"mouseup"==a.type&&(this.mouseIsPressed=!1)}.bind(this),_resizeHandler=function(){this.canvas.width=Utils.getElementWidth(),this.canvas.height=Utils.getElementWidth()}.bind(this),initialize=function(a){_initializeCanvas(),_initializeParticles(a),_initializeTargetPosition(),window.addEventListener("resize",this._resizeHandler),this.canvas.addEventListener("mousemove",_mouseMoveHandler),this.canvas.addEventListener("mousedown",_mouseClickHandler),this.canvas.addEventListener("mouseup",_mouseClickHandler),_draw()}.bind(this);var b=function(a){a.backgroundColor&&"string"!=typeof a.backgroundColor&&console.error("Swarm: 'backgroundColor' must be a string!"),[a.numberOfParticles,a.speed,a.minSize,a.maxSize].forEach(function(a){a&&"number"!=typeof a&&console.error("Swarm: '"+a+"' is not an integer!")}),a.colors&&"object"!=typeof a.colors&&console.error("Swarm: colors must be an array!")};return b(a),initialize(a),particle=new Particle(a),{element:element,numberOfParticles:numberOfParticles,backgroundColor:backgroundColor,colors:particle.colors,speed:particle.maximumMovementSpeed,minSize:particle.minimumSize,maxSize:particle.maximumSize}},Particle=function(a){this.colors=a.colors||["#105B63","#FFD34E","#DB9E36","#BD4932","#FFFFFF"],this.maximumMovementSpeed=a.speed||1,this.minimumSize=a.minSize||2,this.maximumSize=a.maxSize||10,this.drawInCanvas=function(a){a.fillStyle=this.color,a.fillRect(this.position.x,this.position.y,this.size,this.size)},this.moveToPosition=function(a,b){var c=30,d=Math.abs(this.position.x-a.x),e=Math.abs(this.position.y-a.y),f=d/(b*c),g=e/(b*c);this.position.x=this.position.x>a.x?this.position.x-f:this.position.x+f,this.position.y=this.position.y>a.y?this.position.y-g:this.position.y+g},this.moveToRandomPosition=function(a){var b={x:Utils.randomXPositionInWindow(),y:Utils.randomYPositionInWindow()};this.moveToPosition(b,a)},this._getRandomSize=function(){return Math.random()*this.maximumSize+this.minimumSize},this._getRandomParticleColor=function(){var a=Math.floor(Math.random()*this.colors.length);return this.colors[a]},this.size=this._getRandomSize(),this.position={x:Utils.randomXPositionInWindow(),y:Utils.randomYPositionInWindow()},this.color=this._getRandomParticleColor()},Utils={randomXPositionInWindow:function(){return Math.floor(Math.random()*this.getElementWidth())},randomYPositionInWindow:function(){return Math.floor(Math.random()*this.getElementHeight())},getElementWidth:function(){return element.clientWidth},getElementHeight:function(){return element.clientHeight}};